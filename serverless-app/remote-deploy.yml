service: tsw

plugins:
  - serverless-stage-manager

provider:
  name: aws
  runtime: java8
  region: eu-west-1
  timeout: 10
  stage: ${opt:stage,'staging'}
  vpc:
    securityGroupIds:
      - <change>
    subnetIds:
      - <change>
      - <change>
      - <change>

  environment:
    DB_HOST: ${self:custom.dbHost.${self:provider.stage}}
    DB_USER: ${self:custom.dbUser.${self:provider.stage}}
    DB_PASSWORD: ${self:custom.dbPassword.${self:provider.stage}}
    DB_DATABASE: ${self:custom.dbDatabase.${self:provider.stage}}
    DB_PORT: ${self:custom.dbPort.${self:provider.stage}}

package:
  artifact: build/libs/serverless-app-all.jar

custom:
  stages:
    - staging
    - prod
  dbHost:
    staging: <change>
    prod: <change>
  dbUser:
    staging: tswdatabase
    prod: tswdatabase
  dbPassword:
    staging: <change> #${ssm:/<change>/<change>~true}
    prod: null
  dbDatabase:
    staging: tswdatabase
    prod: tswdatabase
  dbPort:
    staging: '5432'
    prod: '5432'